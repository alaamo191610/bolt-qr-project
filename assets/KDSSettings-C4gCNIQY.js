import{r as o,a as b,j as e}from"./index-FBn7Kh98.js";import{a as x}from"./defaults-By8L-jCx.js";function u({value:i,onChange:a,children:l}){return e.jsx("select",{className:"border rounded-md px-2 py-1",value:i,onChange:c=>a(c.target.value),children:l})}function v({checked:i,onChange:a,label:l}){return e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:c=>a(c.target.checked)})," ",l]})}function S({adminId:i}){const[a,l]=o.useState(x),[c,h]=o.useState(!0),[p,g]=o.useState(!1),[d,r]=o.useState(!1);o.useEffect(()=>{let t=!0;return(async()=>{h(!0);try{const s=await b.getAdminSettings(i),n=s==null?void 0:s.kds_prefs;l(n&&Object.keys(n).length?n:x),r(!1)}catch(s){console.error(s),l(x)}finally{t&&h(!1)}})(),()=>{t=!1}},[i]);const f=["pending","preparing","ready","served","cancelled"],j=(t,s)=>{l(n=>{const m=[...n.columns],[y]=m.splice(t,1);return m.splice(s,0,y),{...n,columns:m}}),r(!0)},N=async()=>{g(!0);try{await b.saveKDSPrefs(i,a),r(!1)}catch(t){alert("Failed to save: "+(t==null?void 0:t.message))}finally{g(!1)}};return c?e.jsx("div",{className:"p-6 rounded-xl border bg-white",children:"Loading KDS settings…"}):e.jsxs("section",{className:"bg-white rounded-xl border shadow-sm p-6 space-y-6",children:[e.jsx("header",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Kitchen Display Settings"}),e.jsx("p",{className:"text-slate-600 text-sm",children:"Control how tickets show in the kitchen and auto-advance behavior."})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-slate-800 mb-2",children:"Columns"}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:a.columns.map((t,s)=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full border bg-white",children:[t,e.jsxs("div",{className:"flex",children:[e.jsx("button",{"aria-label":"Move left",className:"ml-1 w-6 h-6 rounded border",onClick:()=>j(s,Math.max(0,s-1)),disabled:s===0,children:"←"}),e.jsx("button",{"aria-label":"Move right",className:"ml-1 w-6 h-6 rounded border",onClick:()=>j(s,Math.min(a.columns.length-1,s+1)),disabled:s===a.columns.length-1,children:"→"})]})]},t+s))}),e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Visible statuses (left→right). You can include/exclude any of: ",f.join(", "),"."]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-6 space-y-3",children:[e.jsx(v,{checked:a.soundEnabled,onChange:t=>{l(s=>({...s,soundEnabled:t})),r(!0)},label:"Enable sound alerts"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Sound preset"}),e.jsxs(u,{value:a.soundPreset,onChange:t=>{l(s=>({...s,soundPreset:t})),r(!0)},children:[e.jsx("option",{value:"ding",children:"ding"}),e.jsx("option",{value:"bell",children:"bell"}),e.jsx("option",{value:"knock",children:"knock"}),e.jsx("option",{value:"beep",children:"beep"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Auto-bump after (min)"}),e.jsx("input",{type:"number",min:0,className:"w-24 border rounded-md px-2 py-1 text-right",value:a.autoBumpMinutes,onChange:t=>{const s=Math.max(0,Number(t.target.value||0));l(n=>({...n,autoBumpMinutes:s})),r(!0)}})]})]}),e.jsxs("div",{className:"col-span-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Ticket scale"}),e.jsx("input",{type:"range",min:.8,max:1.4,step:.05,value:a.ticketScale,onChange:t=>{l(s=>({...s,ticketScale:Number(t.target.value)})),r(!0)}}),e.jsxs("span",{className:"text-sm tabular-nums",children:[a.ticketScale.toFixed(2),"x"]})]}),e.jsx(v,{checked:a.showModifiersLarge,onChange:t=>{l(s=>({...s,showModifiersLarge:t})),r(!0)},label:"Show modifiers large"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Color scheme"}),e.jsxs(u,{value:a.colorScheme,onChange:t=>{l(s=>({...s,colorScheme:t})),r(!0)},children:[e.jsx("option",{value:"light",children:"light"}),e.jsx("option",{value:"dark",children:"dark"}),e.jsx("option",{value:"high-contrast",children:"high-contrast"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Group tickets"}),e.jsxs(u,{value:a.ticketGrouping,onChange:t=>{l(s=>({...s,ticketGrouping:t})),r(!0)},children:[e.jsx("option",{value:"none",children:"none"}),e.jsx("option",{value:"byTable",children:"byTable"}),e.jsx("option",{value:"byCourse",children:"byCourse"})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"OK ≤"}),e.jsx("input",{type:"number",min:1,className:"w-20 border rounded-md px-2 py-1 text-right",value:a.prepTimeColors.ok,onChange:t=>{const s=Math.max(1,Number(t.target.value||1));l(n=>({...n,prepTimeColors:{...n.prepTimeColors,ok:s}})),r(!0)}}),e.jsx("span",{className:"text-sm text-slate-600",children:"min"})]}),e.jsxs("div",{className:"col-span-6 flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Warn ≤"}),e.jsx("input",{type:"number",min:1,className:"w-20 border rounded-md px-2 py-1 text-right",value:a.prepTimeColors.warn,onChange:t=>{const s=Math.max(a.prepTimeColors.ok+1,Number(t.target.value||a.prepTimeColors.ok+1));l(n=>({...n,prepTimeColors:{...n.prepTimeColors,warn:s}})),r(!0)}}),e.jsx("span",{className:"text-sm text-slate-600",children:"min"})]})]}),e.jsx("footer",{className:"pt-2",children:e.jsx("button",{onClick:N,disabled:!d||p,className:`px-4 py-2 rounded-lg text-sm font-medium border shadow-sm ${d?"bg-emerald-600 text-white border-emerald-700":"bg-slate-100 text-slate-500 border-slate-200"}`,children:p?"Saving…":d?"Save changes":"Saved"})})]})}export{S as default};
